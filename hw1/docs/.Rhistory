library(scales)
library(DT)
library(RColorBrewer)
library(ggalt)
library(plotly)
olymp <- read.csv("../data/winter.csv")
gdp <- read.csv("../data/dictionary.csv")
olymp$Year <- as.Date(strptime(olymp$Year, format = "%Y"))
colnames(gdp) <- c("Country_Full", "Country", "Population", "GDP.per.Capita")
# How many winter game Medal types per country
# Combine RUS and URS, and GER, EUA, FRG, GDR
olymp$Country <- as.character(olymp$Country)
olymp$Country <- ifelse(olymp$Country == "URS", "RUS", olymp$Country)
olymp$Country <- ifelse(olymp$Country == "EUA", "GER", olymp$Country)
olymp$Country <- ifelse(olymp$Country == "FRG", "GER", olymp$Country)
olymp$Country <- ifelse(olymp$Country == "GDR", "GER", olymp$Country)
olymp$Country <- as.factor(olymp$Country)
descriptive1 <- olymp %>%
mutate(Medal = factor(Medal, levels = c("Gold", "Silver", "Bronze"))) %>%
group_by(Country, Medal) %>%
mutate(medal_yr_cnt = length(Medal)) %>%
select(Country, Medal, medal_yr_cnt) %>%
unique() %>%
spread(key = Medal, value = medal_yr_cnt) %>%
ungroup() %>%
select(Country, Gold, Silver, Bronze)
descriptive1[is.na(descriptive1)] <- 0
# How many years in Olympics
descriptive2 <- olymp %>%
select(Country, Year) %>%
group_by(Country) %>%
unique() %>%
summarize(num_olymp = n())
# Combination -- Number of Olympics and Medals per Country
descriptive <- inner_join(descriptive1, descriptive2, by = "Country")
descriptive$total_medals <- rowSums(descriptive[, c(2,3,4)])
# Joining GDP information for later
descriptive_gdp <- inner_join(descriptive, gdp, by = "Country")
# Who are the top 10 medal producers over time?
top10 <- descriptive %>%
arrange(desc(total_medals)) %>%
mutate(rank = row_number()) %>%
filter(rank <= 10)
# Calculate how many medals per year in top 10 countries
medalsyear <- olymp %>%
group_by(Year, Country) %>%
filter(Country %in% top10$Country) %>%
summarize(medal_yr_cnt = length(Medal))
# Split by gold, silver, bronze medals, over time
medals_year <- olymp %>%
mutate(Medal = factor(Medal, levels = c("Gold", "Silver", "Bronze"))) %>%
group_by(Year, Country, Medal) %>%
summarize(medal_yr_cnt = length(Medal))
# filter for only countries that have at least 100 medals
medals100 <- olymp %>%
group_by(Country) %>%
summarize(total_medals = length(Medal)) %>%
filter(total_medals >= 100)
# Split by Country, over time
# Probably not this one
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt, na.rm = TRUE)) +
geom_jitter(aes(color = Medal)) +
scale_color_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "# Medals Won") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
# The winning "over time" plot
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt, na.rm = TRUE)) +
geom_area(aes(fill = Medal), alpha = 0.8) +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt, na.rm = TRUE)) +
geom_bkde(aes(fill = Medal), alpha = 0.8) +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
dev_mode(FALSE)
library(devtools)
dev_mode(FALSE)
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt, na.rm = TRUE)) +
geom_area(aes(fill = Medal), alpha = 0.8) +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt, na.rm = TRUE)) +
geom_area(aes(fill = Medal), alpha = 0.8, stat = "identity") +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
View(medals_year)
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt, na.rm = TRUE)) +
geom_area(aes(fill = Medal), alpha = 0.8, stat = "identity")
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt, na.rm = TRUE))
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt, na.rm = TRUE)) +
geom_area(aes(fill = Medal), alpha = 0.8, stat = "bin") +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt)) +
geom_area(aes(fill = Medal, color = Medal), alpha = 0.8)
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt)) +
geom_area(aes(color = Medal), alpha = 0.8)
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt)) +
geom_jitter(aes(color = Medal))
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt)) +
geom_area(aes(color = Medal))
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt)) +
geom_line(aes(color = Medal)) +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
# The winning "over time" plot
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt)) +
geom_line(aes(fill = Medal)) +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(scales)
library(DT)
library(RColorBrewer)
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt)) +
geom_area(aes(fill = Medal)) +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(scales)
library(DT)
library(RColorBrewer)
olymp <- read.csv("../data/winter.csv")
gdp <- read.csv("../data/dictionary.csv")
olymp$Year <- as.Date(strptime(olymp$Year, format = "%Y"))
colnames(gdp) <- c("Country_Full", "Country", "Population", "GDP.per.Capita")
# How many winter game Medal types per country
# Combine RUS and URS, and GER, EUA, FRG, GDR
olymp$Country <- as.character(olymp$Country)
olymp$Country <- ifelse(olymp$Country == "URS", "RUS", olymp$Country)
olymp$Country <- ifelse(olymp$Country == "EUA", "GER", olymp$Country)
olymp$Country <- ifelse(olymp$Country == "FRG", "GER", olymp$Country)
olymp$Country <- ifelse(olymp$Country == "GDR", "GER", olymp$Country)
olymp$Country <- as.factor(olymp$Country)
descriptive1 <- olymp %>%
mutate(Medal = factor(Medal, levels = c("Gold", "Silver", "Bronze"))) %>%
group_by(Country, Medal) %>%
mutate(medal_yr_cnt = length(Medal)) %>%
select(Country, Medal, medal_yr_cnt) %>%
unique() %>%
spread(key = Medal, value = medal_yr_cnt) %>%
ungroup() %>%
select(Country, Gold, Silver, Bronze)
descriptive1[is.na(descriptive1)] <- 0
# How many years in Olympics
descriptive2 <- olymp %>%
select(Country, Year) %>%
group_by(Country) %>%
unique() %>%
summarize(num_olymp = n())
# Combination -- Number of Olympics and Medals per Country
descriptive <- inner_join(descriptive1, descriptive2, by = "Country")
descriptive$total_medals <- rowSums(descriptive[, c(2,3,4)])
# Joining GDP information for later
descriptive_gdp <- inner_join(descriptive, gdp, by = "Country")
# Who are the top 10 medal producers over time?
top10 <- descriptive %>%
arrange(desc(total_medals)) %>%
mutate(rank = row_number()) %>%
filter(rank <= 10)
# Calculate how many medals per year in top 10 countries
medalsyear <- olymp %>%
group_by(Year, Country) %>%
filter(Country %in% top10$Country) %>%
summarize(medal_yr_cnt = length(Medal))
# Split by gold, silver, bronze medals, over time
medals_year <- olymp %>%
mutate(Medal = factor(Medal, levels = c("Gold", "Silver", "Bronze"))) %>%
group_by(Year, Country, Medal) %>%
summarize(medal_yr_cnt = length(Medal))
# filter for only countries that have at least 100 medals
medals100 <- olymp %>%
group_by(Country) %>%
summarize(total_medals = length(Medal)) %>%
filter(total_medals >= 100)
# Split by Country, over time
# Probably not this one
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt, na.rm = TRUE)) +
geom_jitter(aes(color = Medal)) +
scale_color_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "# Medals Won") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
# The winning "over time" plot
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt)) +
geom_area(aes(fill = Medal)) +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt)) +
ggplot2::geom_area(aes(fill = Medal)) +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt)) +
geom_line(aes(fill = Medal)) +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
ggplot(medals_year, aes(x=Year)) +
stat_bkde(alpha=1/2)
library(ggalt)
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt)) +
geom_area(aes(fill = Medal)) +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
ggplot(medals_year, aes(x=Year)) +
stat_bkde(alpha=1/2)
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, ymax = medal_yr_cnt)) +
geom_area(aes(fill = Medal)) +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
?geom_area
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt)) +
geom_area(aes(x = Year, y = medal_yr_cnt, fill = Medal)) +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
library(ggplot2)
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt)) +
geom_area(aes(x = Year, y = medal_yr_cnt, fill = Medal)) +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
medalsyear %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt)) +
geom_area(aes(x = Year, y = medal_yr_cnt, fill = Medal)) +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
View(medalsyear)
# Split by Country, over time
# Probably not this one
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt, na.rm = TRUE)) +
geom_jitter(aes(color = Medal)) +
scale_color_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "# Medals Won") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
# The winning "over time" plot
library(ggalt)
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt)) +
geom_area(aes(x = Year, y = medal_yr_cnt, fill = Medal)) +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
medals_year <- olymp %>%
mutate(Medal = factor(Medal, levels = c("Gold", "Silver", "Bronze"))) %>%
group_by(Year, Country, Medal) %>%
summarize(medal_yr_cnt = length(Medal))
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt)) +
geom_area(aes(x = Year, y = medal_yr_cnt, fill = Medal)) +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
medals_year %>%
ggplot(aes(x = Year, y = medal_yr_cnt, na.rm = TRUE)) +
geom_area(aes( fill = Medal), alpha = 0.8) +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "Year", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
#scale_x_date(date_labels = "%Y", date_breaks = "17 years") +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(scales)
library(RColorBrewer)
olymp <- read.csv("../data/winter.csv")
gdp <- read.csv("../data/dictionary.csv")
olymp$Year <- as.Date(strptime(olymp$Year, format = "%Y"))
colnames(gdp) <- c("Country_Full", "Country", "Population", "GDP.per.Capita")
# How many winter game Medal types per country
# Combine RUS and URS, and GER, EUA, FRG, GDR
olymp$Country <- as.character(olymp$Country)
olymp$Country <- ifelse(olymp$Country == "URS", "RUS", olymp$Country)
olymp$Country <- ifelse(olymp$Country == "EUA", "GER", olymp$Country)
olymp$Country <- ifelse(olymp$Country == "FRG", "GER", olymp$Country)
olymp$Country <- ifelse(olymp$Country == "GDR", "GER", olymp$Country)
olymp$Country <- as.factor(olymp$Country)
descriptive1 <- olymp %>%
mutate(Medal = factor(Medal, levels = c("Gold", "Silver", "Bronze"))) %>%
group_by(Country, Medal) %>%
mutate(medal_yr_cnt = length(Medal)) %>%
select(Country, Medal, medal_yr_cnt) %>%
unique() %>%
spread(key = Medal, value = medal_yr_cnt) %>%
ungroup() %>%
select(Country, Gold, Silver, Bronze)
descriptive1[is.na(descriptive1)] <- 0
# How many years in Olympics
descriptive2 <- olymp %>%
select(Country, Year) %>%
group_by(Country) %>%
unique() %>%
summarize(num_olymp = n())
# Combination -- Number of Olympics and Medals per Country
descriptive <- inner_join(descriptive1, descriptive2, by = "Country")
descriptive$total_medals <- rowSums(descriptive[, c(2,3,4)])
# Joining GDP information for later
descriptive_gdp <- inner_join(descriptive, gdp, by = "Country")
# Who are the top 10 medal producers over time?
top10 <- descriptive %>%
arrange(desc(total_medals)) %>%
mutate(rank = row_number()) %>%
filter(rank <= 10)
# Calculate how many medals per year in top 10 countries
medalsyear <- olymp %>%
group_by(Year, Country) %>%
filter(Country %in% top10$Country) %>%
summarize(medal_yr_cnt = length(Medal))
# Split by gold, silver, bronze medals, over time
medals_year <- olymp %>%
mutate(Medal = factor(Medal, levels = c("Gold", "Silver", "Bronze"))) %>%
group_by(Year, Country, Medal) %>%
summarize(medal_yr_cnt = length(Medal))
# filter for only countries that have at least 100 medals
medals100 <- olymp %>%
group_by(Country) %>%
summarize(total_medals = length(Medal)) %>%
filter(total_medals >= 100)
# Split by Country, over time
# Probably not this one
medals_year %>%
filter(Country %in% top10$Country) %>%
ggplot(aes(x = Year, y = medal_yr_cnt, na.rm = TRUE)) +
geom_jitter(aes(color = Medal)) +
scale_color_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "", y = "# Medals Won") +
facet_wrap(~Country) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
# The winning "over time" plot
library(ggalt)
medals_year %>%
ggplot(aes(x = Year, y = medal_yr_cnt, na.rm = TRUE)) +
geom_area(aes( fill = Medal), alpha = 0.8) +
scale_fill_manual(values=c("gold","grey73","darkgoldenrod4")) +
labs(x = "Year", y = "Medals Won",
title = "Olympic Medals by Country",
subtitle = "Winter Olympics 1924 - 2014") +
facet_wrap(~Country) +
#scale_x_date(date_labels = "%Y", date_breaks = "17 years") +
theme_light() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(strip.background = element_rect(fill = "lightskyblue2"))
